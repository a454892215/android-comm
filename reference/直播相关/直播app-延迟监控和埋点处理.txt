
在专业直播 App（尤其是体育直播、电竞直播、互动直播）里，延迟监控上报通常会在 三个阶段埋点：
1️⃣ 数据接收阶段（Network / ExoPlayer 拉流阶段）
ExoPlayer 刚接收到视频/音频切片或 RTP/RTMP 帧数据的时刻
* **目的**：
  * 统计网络传输延迟（端到端延迟的一部分）
  * 判断网络是否慢或丢包
* **指标**：
  * 服务器推流时间戳 vs 客户端收到时间戳
  * 延迟 = `接收时间 - 服务器时间`
* **专业用途**：
  * 网络链路质量监控
  * CDN 节点性能分析
* **典型上报**：
  * 可能按切片/帧间隔上报
  * 或累积统计每秒平均延迟
---

### 2️⃣ 播放阶段（播放器播放时间点）
* **位置**：ExoPlayer 实际渲染帧时
* **目的**：
  * 统计 **真实播放延迟**，也就是用户看到的延迟
  * 包含 **网络延迟 + 解码延迟 + 渲染延迟**
* **指标**：
  * `player.getCurrentLiveOffset()`（或每帧时间戳计算）
  * 平均延迟、P95、最大延迟
* **专业用途**：
  * 用户体验监控
  * 追帧策略判断（当延迟过大时触发追帧）
* **典型上报**：
  * 每秒或每 N 秒上报一次
  * 异常延迟（> 阈值）立即上
---
### 3️⃣ 关键事件阶段（可选，但专业必备）
* **事件类型**：
  * 重缓冲（Buffering start/end）
  * 追帧/丢帧事件
  * 播放异常（花屏、黑屏）
* **目的**：
  * 帮助后台判断延迟高的原因
  * 统计延迟与播放稳定性的关系
* **上报策略**：
  * 事件发生立即上报
  * 可配合平均延迟一起分析
---